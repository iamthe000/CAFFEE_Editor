# ☕ CAFFEE (カフィー)
<a href="https://github.com/iamthe000/CAFFEE_Editor_Japanese_UI_plugin_Official.git">公式UI日本語化プラグイン</a>
CAFFEEは、**Python**で書かれ、**curses**ライブラリを使用した軽量なターミナルテキストエディタです。シンプルな操作感とプラグインによる拡張性を目指し、ターミナル内での素早い編集に適しています。

## 💡 特徴

  * **小型で集中**した編集体験
  * **Undo/Redo**履歴機能
  * マークベースの**選択**とクリップボード操作（カット/コピー/ペースト）
  * 行操作（削除、コメント/アンコメント、指定行へのジャンプ）
  * バックアップファイル作成を伴う**アトミックなファイル保存**
  * **プラグインシステム**: ユーザープラグインディレクトリからのPythonファイルのロード
  * **JSON設定ファイル**によるタブ幅や色の設定

-----

## 💻 インストールと利用方法

### インストール

1.  **Python 3**がインストールされていることを確認します。
2.  `caffee.py`を**PATH**の通った場所に置くか、直接実行します。

### 利用方法

  * `python3 caffee.py` で新しいバッファを開きます。
  * `python3 caffee.py /path/to/file` で既存のファイルを編集します。
  * **curses**ベースのUIを使用するため、ターミナルエミュレータ内で実行してください。

-----

## ⌨️ 主なキーバインディング

| キー | 機能 |
| :--- | :--- |
| **Ctrl+O** | 保存 |
| **Ctrl+X** | 終了（未保存の変更がある場合はプロンプトが表示されます） |
| **Ctrl+W** | 検索 |
| **Ctrl+K** | カット（行または選択範囲） |
| **Ctrl+U** | ペースト |
| **Ctrl+6** | マークの切り替え（選択範囲の開始/終了） |
| **Ctrl+A** | 全選択 / 選択解除 |
| **Ctrl+G** | 指定行へジャンプ (Go to line) |
| **Ctrl+E** | 行末へ移動 (Move to End of line) |
| **Ctrl+/** | 現在行のコメント/アンコメント切り替え |
| **Ctrl+Y** | 行を削除 |
| **Ctrl+Z** | Undo（元に戻す） |
| **Ctrl+R** | Redo（やり直し） |
| **矢印キー / PageUp / PageDown** | ナビゲーション（移動） |

> **注意:** Altキーと `6` キーの組み合わせでコピーが動作するターミナルもあります（動作はターミナルのキーマッピングに依存します）。行頭での**Backspace**は行を結合します。

-----

## ⚙️ 設定

ユーザー設定は `~/.caffee_setting/setting.json` に保存されます。

**設定ファイルの例:**

```json
{
  "tab_width": 4,
  "history_limit": 100,
  "use_soft_tabs": true,
  "colors": {
    "header_text": "BLACK",
    "header_bg": "WHITE",
    "error_text": "WHITE",
    "error_bg": "RED",
    "linenum_text": "CYAN",
    "linenum_bg": "DEFAULT",
    "selection_text": "BLACK",
    "selection_bg": "CYAN"
  }
}
```

-----

## 🧩 プラグイン

プラグインは `~/.caffee_setting/plugins/` に配置するシンプルなPythonファイルです。

  * プラグインは `init(editor)` 関数を公開することができ、これがEditorインスタンスと共に呼び出されます。
  * `editor.bind_key(key_code, function)` を使用して、プラグインからキーハンドラを登録できます。

**プラグインのスケルトン例:**

```python
def init(editor):
    def hello(ed):
        ed.set_status("Hello from plugin!", timeout=2)
    editor.bind_key(9999, hello)
```

-----

## 🛠️ トラブルシューティングと開発

### トラブルシューティング

  * cursesエラーが発生した場合は、ターミナルが必要な機能に対応しているか、またPythonのcursesライブラリがプラットフォームで利用可能であることを確認してください。
  * ディスク上のファイル変更は検出され通知されますが、ローカルでの変更の上書きを防ぐため、**自動リロードは行われません**。

### 開発

  * メインソースファイルは `caffee.py` です。
  * テストは含まれていません。手動テストのためにターミナルでエディタを実行してください。
  * 変更は最小限にとどめ、ターミナルのリサイズ動作に配慮してください。

-----

## 🤝 貢献とライセンス

  * **貢献:** リポジトリをフォークし、変更を加えてプルリクエストを送信してください。小さく焦点を絞ったパッチを提供し、明確な変更内容を記述してください。
  * **ライセンス:** **MITライセンス**。
